<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="SwissSymAthDQM03">
	
	<select id="selectUserGrpDetailSearch" parameterType="java.util.Map" resultType="java.util.Map">
            SELECT A.USER_GRP_ID
                 , A.USER_ID
                 , B.USER_NM
                 , B.SOSOK
                 , B.JIKWI
                 , A.BUYEO_DT
                 , A.USE_YN 
              FROM SGGHUGRU00TT A, SGSYUSER00TT B
             WHERE 1=1
               AND A.USER_ID = B.USER_ID
               AND NVL(A.USER_GRP_ID, ' ') = #{USER_GRP_ID}
               AND NVL(B.SOSOK, ' ')       LIKE #{SOSOK}||'%'
               AND NVL(B.USER_NM, ' ')     LIKE #{USER_NM}||'%'
          ORDER BY A.USER_GRP_ID, A.USER_ID
	</select>
	    
	<insert id="saveUserGrpDetail" parameterType="java.util.Map">
			MERGE INTO SGGHUGRU00TT
			USING DUAL
			   ON (    USER_GRP_ID = #{USER_GRP_ID}
			       AND USER_ID     = #{USER_ID}
			      )
			 WHEN MATCHED THEN
			      UPDATE SET USE_YN       = #{USE_YN}
                           , UPDATE_MAN   = 'system'
                           , UPDATE_DT    = sysdate                           
             WHEN NOT MATCHED THEN
        	      INSERT (USER_GRP_ID, USER_ID, BUYEO_DT, USE_YN, UPDATE_MAN, UPDATE_DT)
        	      VALUES (#{USER_GRP_ID}, #{USER_ID}, sysdate, #{USE_YN},'system', sysdate)
    </insert>

    <delete id="deleteUserGrpDetail" parameterType="java.util.Map">
         	DELETE FROM SGGHUGRU00TT
        	 WHERE USER_GRP_ID = #{USER_GRP_ID}
        	   AND USER_ID     = #{USER_ID}
    </delete>	
</mapper>