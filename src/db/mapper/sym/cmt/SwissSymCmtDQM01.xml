<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="SwissSymCmtDQM01">
	
	<select id="selectGongJi" parameterType="java.util.Map" resultType="java.util.Map">
			SELECT ROWNUM AS RN,
			       GJ_SB,
			       GJ_JM,
			       GJ_NY,
			       SEL_CNT,
			       JAK_ID,
			       JAK_NM,
			       TO_CHAR(JAK_DT,'YYYY-MM-DD') AS JAK_DT,
			       GG_YN,
			       DECODE(GG_YN,'Y','긴급','일반') AS GG_YN_NM,
			       DEL_YN,
			       DECODE(DEL_YN, 'Y','비게시','게시') AS DEL_YN_NM
			  FROM SGCMGJSH00TT A
			 WHERE 1=1
			 
			<if test="GJ_SB != null">
				AND GJ_SB = #{GJ_SB}
			</if>
			
			<if test="SELECT_OPTION.equals('GJ_JM') and SELECT_VALUE != null">
				AND GJ_JM LIKE '%' || #{SELECT_VALUE} || '%'
			</if>
			
			<if test="SELECT_OPTION.equals('GJ_NY') and SELECT_VALUE != null">
				AND GJ_NY LIKE '%' || #{SELECT_VALUE} || '%'
			</if>
			
			<if test="SELECT_OPTION.equals('GJ_JM_NY') and SELECT_VALUE != null">
				AND (GJ_JM LIKE '%' || #{SELECT_VALUE} || '%' OR GJ_NY LIKE '%' || #{SELECT_VALUE} || '%')
			</if>
			
			<if test="DEL_YN != null">
				AND DEL_YN = #{DEL_YN}
			</if>
			
			<if test="GS_GB != null">
				AND GS_GB IN ('1', #{GS_GB})
			</if>
			
			<if test="LIMIT != null">
				<![CDATA[
				AND ROWNUM < #{LIMIT}
				]]>
			</if>
			 
			 
			 ORDER BY GG_YN DESC, GJ_SB DESC
	</select>
	
	<insert id="insertGongJi" parameterType="java.util.Map">
			INSERT INTO SGCMGJSH00TT(GJ_SB, GJ_JM, GJ_NY, SEL_CNT, JAK_ID, JAK_NM, JAK_DT, GG_YN, DEL_YN)
			VALUES((select nvl(max(gj_sb),0) + 1 from SGCMGJSH00TT), #{GJ_JM}, #{GJ_NY}, 0, #{JAK_ID}, #{JAK_NM}, SYSDATE, #{GG_YN}, #{DEL_YN})	
    </insert>
	
    <update id="updateGongJi" parameterType="java.util.Map">
        	UPDATE SGGHPAGE00TT SET
        		SYSTEM_ID = #{SYSTEM_ID},
        		PAGE_ID = #{PAGE_ID},
        		PAGE_NM = #{PAGE_NM},
        		PAGE_DESC = #{PAGE_DESC},
        		PAGE_PATH = #{PAGE_PATH},
        		USE_YN = #{USE_YN},
        		UPDATE_MAN = #{UPDATE_MAN},
        		UPDATE_DT = SYSDATE
        	WHERE SYSTEM_ID = #{SYSTEM_ID}
        	  AND PAGE_ID = #{PAGE_ID}
    </update>

    <delete id="deletePage" parameterType="java.util.Map">
    		DELETE
    		  FROM SGGHPAGE00TT
    		 WHERE SYSTEM_ID = #{SYSTEM_ID}
        	   AND PAGE_ID = #{PAGE_ID}
    </delete>
    

</mapper>